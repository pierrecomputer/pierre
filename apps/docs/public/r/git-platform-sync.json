{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "git-platform-sync",
  "type": "registry:block",
  "title": "Git Platform Sync",
  "description": "A component that implements repo syncing between code.storage and git platforms like GitHub.",
  "dependencies": [
    "@pierre/sync-ui-core",
    "@pierre/sync-ui-hooks"
  ],
  "registryDependencies": [
    "button",
    "command",
    "field",
    "input",
    "popover",
    "select"
  ],
  "files": [
    {
      "path": "registry/new-york/blocks/git-platform-sync/git-platform-sync.tsx",
      "content": "'use client';\n\nimport { Button } from '@/components/ui/button';\nimport {\n  Popover,\n  PopoverContent,\n  PopoverTrigger,\n} from '@/components/ui/popover';\nimport { cn } from '@/lib/utils';\nimport * as PopoverPrimitive from '@radix-ui/react-popover';\nimport { ChevronDown } from 'lucide-react';\nimport { useState } from 'react';\n\nimport { ComboBox } from './combobox';\n\n// TODO: determine if this is the canonical way to import other components inside of a block\n\ntype Step = 'welcome' | 'sync';\n\ntype RepositoryData = {\n  /**\n   * @description The owner of the repository, also referred to as the 'scope' - usually\n   * the username of the user or an organization they belong to.\n   */\n  owner?: string;\n  /**\n   * @description The name of the repository, this is a 'slug' style name.\n   */\n  name?: string;\n  /**\n   * @description The branch of the repository, this is the branch that will be used to sync\n   */\n  branch?: string;\n};\n\ntype RepositoryDataStatus = 'valid' | 'invalid' | 'incomplete';\ntype RespositoryInvalidReason = 'repo-name-collision';\n\ntype RepositoryChangeStatus = {\n  status: RepositoryDataStatus;\n  reason?: RespositoryInvalidReason;\n};\n\nconst GitHubIcon = ({ className, ...props }: React.SVGProps<SVGSVGElement>) => (\n  <svg\n    viewBox=\"0 0 16 16\"\n    fill=\"none\"\n    xmlns=\"http://www.w3.org/2000/svg\"\n    className={cn('h-full w-auto text-foreground', className)}\n    {...props}\n  >\n    <path\n      d=\"M8 0C12.42 0 16 3.58 16 8C15.9996 9.6762 15.4735 11.3101 14.4958 12.6716C13.5182 14.0332 12.1381 15.0539 10.55 15.59C10.15 15.67 10 15.42 10 15.21C10 14.94 10.01 14.08 10.01 13.01C10.01 12.26 9.76 11.78 9.47 11.53C11.25 11.33 13.12 10.65 13.12 7.58C13.12 6.7 12.81 5.99 12.3 5.43C12.38 5.23 12.66 4.41 12.22 3.31C12.22 3.31 11.55 3.09 10.02 4.13C9.38 3.95 8.7 3.86 8.02 3.86C7.34 3.86 6.66 3.95 6.02 4.13C4.49 3.1 3.82 3.31 3.82 3.31C3.38 4.41 3.66 5.23 3.74 5.43C3.23 5.99 2.92 6.71 2.92 7.58C2.92 10.64 4.78 11.33 6.56 11.53C6.33 11.73 6.12 12.08 6.05 12.6C5.59 12.81 4.44 13.15 3.72 11.94C3.57 11.7 3.12 11.11 2.49 11.12C1.82 11.13 2.22 11.5 2.5 11.65C2.84 11.84 3.23 12.55 3.32 12.78C3.48 13.23 4 14.09 6.01 13.72C6.01 14.39 6.02 15.02 6.02 15.21C6.02 15.42 5.87 15.66 5.47 15.59C3.87664 15.0596 2.49073 14.041 1.50889 12.6786C0.527047 11.3163 -0.000880479 9.67931 1.10231e-06 8C1.10231e-06 3.58 3.58 0 8 0Z\"\n      fill=\"currentColor\"\n    />\n  </svg>\n);\n\n/**\n * @description Platforms that code.storage supports\n */\nexport type SupportedGitPlatform = 'github';\nexport type GitPlatformSyncProps = React.ComponentProps<typeof Popover> & {\n  /**\n   * @default ['github']\n   * @description List of supported platforms that you want to offer to the user\n   */\n  platforms?: SupportedGitPlatform[];\n  /**\n   * @default 'default'\n   * @description Variant display of the button that opens the sync popover\n   */\n  variant?: 'default' | 'icon-only';\n  /**\n   * @default true\n   * @description Whether to show the sync indicator in the button, e.g. the little colored dot\n   */\n  showSyncIndicator?: boolean;\n  /**\n   * @default 'end'\n   * @description The alignment of the popover content\n   */\n  align?: React.ComponentProps<typeof PopoverContent>['align'];\n\n  /**\n   * @description Options for what features to offer the user in the resository selection\n   */\n  repositoryOptions?: {\n    /**\n     * @default false\n     * @description Whether to allow the user to select an existing repository. In most\n     * cases with coding platforms, you'll want to keep this false unless your platform\n     * is able to easily ingest existing repositories.\n     */\n    allowExisting?: boolean;\n    /**\n     * @default undefined\n     * @description The repoository slug that will be used. If it collides with an existing\n     * repository, the user will be able to select a different name.\n     */\n    name?: string;\n    /**\n     * @default false\n     * @description In general it's a good idea to allow users to name the repo whatever they\n     * want, but in some cases you might want to disallow it.\n     */\n    disallowCustomName?: boolean;\n    /**\n     * @default 'main'\n     * @description The branch that will be used to sync within the repository.\n     */\n    branch?: string;\n  };\n\n  /**\n   * @description Callback when the user changes any of the respository configuration. The first\n   * argument to the callback is the repository data. This data can be partial, for instance if the\n   * user hasn't yet selected a repo name.\n   */\n  onRepoChange?: (\n    repoData: RepositoryData,\n    status: RepositoryChangeStatus\n  ) => void;\n\n  onSyncStart?: () => void;\n  /**\n   * @deprecated Internal use only, not guaranteed to be supported in the future\n   * @description The container to render the popover portal in, only used for docs. This requires\n   * modifying the shadcn Popover component to accept a container prop for the portal\n   */\n  __container?: React.ComponentProps<\n    typeof PopoverPrimitive.Portal\n  >['container'];\n};\n\nexport function GitPlatformSync({\n  // currently this is unused since we only support GitHub, but we'll keep it for future use\n  platforms = ['github'],\n  variant = 'default',\n  align = 'end',\n  __container,\n  ...props\n}: GitPlatformSyncProps) {\n  const [step, setStep] = useState<Step>('welcome');\n\n  // We want to make sure the container internal stuff doesn't blow up anyone's types\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  const containerProp: any = __container ? { container: __container } : {};\n\n  let platformName: string | undefined;\n\n  if (platforms.length === 0) {\n    console.error('No platforms provided to GitPlatformSync');\n    return null;\n  }\n\n  if (platforms.length === 1 && platforms[0] === 'github') {\n    platformName = 'GitHub';\n  } else {\n    console.error('Currently GitPlatformSync only supports GitHub');\n    return null;\n  }\n\n  return (\n    <Popover {...props}>\n      <PopoverTrigger asChild>\n        <Button\n          variant=\"outline\"\n          className=\"group flex justify-between items-center gap-2 text-foreground\"\n        >\n          {variant === 'icon-only' ? (\n            <GitHubIcon />\n          ) : (\n            <>\n              <GitHubIcon /> Sync to {platformName}\n              <ChevronDown className=\"h-4 w-4 text-muted-foreground transition-colors group-hover:text-foreground\" />\n            </>\n          )}\n        </Button>\n      </PopoverTrigger>\n      <PopoverContent className=\"w-96\" align={align} {...containerProp}>\n        {step === 'welcome' ? (\n          <StepWelcome onInstallApp={() => setStep('sync')} />\n        ) : null}\n        {step === 'sync' ? <StepSync __container={__container} /> : null}\n      </PopoverContent>\n    </Popover>\n  );\n}\n\ntype StepWelcomeProps = {\n  onInstallApp?: () => void;\n  onHelp?: () => void;\n};\n\nfunction StepWelcome({ onInstallApp, onHelp }: StepWelcomeProps) {\n  return (\n    <>\n      <div className=\"space-y-4\">\n        <div className=\"space-y-2\">\n          <h4 className=\"font-normal leading-none\">Connect to GitHub</h4>\n          <p className=\"text-sm text-muted-foreground\">\n            Sync your changes to GitHub to backup your code at every snapshot by\n            installing our app on your personal account or organization.\n          </p>\n        </div>\n        <div className=\"flex flex-col gap-3\">\n          <Button onClick={onInstallApp} size=\"lg\" className=\"w-full\">\n            Install GitHub App\n          </Button>\n          <Button\n            onClick={onHelp}\n            size=\"lg\"\n            variant=\"secondary\"\n            className=\"w-full\"\n          >\n            Help me get started\n          </Button>\n        </div>\n      </div>\n    </>\n  );\n}\n\ntype StepSyncProps = {\n  onOwnerChange?: (owner: string) => void;\n  onRepoChange?: (repo: string) => void;\n  onBranchChange?: (branch: string) => void;\n  /**\n   * @deprecated Internal use only, not guaranteed to be supported in the future\n   * @description The container to render the popover portal in, only used for docs. This requires\n   * modifying the shadcn Popover component to accept a container prop for the portal\n   */\n  __container?: React.ComponentProps<\n    typeof PopoverPrimitive.Portal\n  >['container'];\n};\n\nfunction StepSync({\n  // onOwnerChange,\n  // onRepoChange,\n  // onBranchChange,\n  __container,\n}: StepSyncProps) {\n  // We want to make sure the container internal stuff doesn't blow up anyone's types\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  const containerProp: any = __container ? { __container: __container } : {};\n\n  return (\n    <>\n      <div className=\"space-y-4\">\n        <div className=\"space-y-2\">\n          <h4 className=\"font-normal leading-none\">Sync to GitHub</h4>\n          <p className=\"text-sm text-muted-foreground\">\n            Create a new repository or choose an existing one to sync your\n            changes. We&apos;ll push changes with each new prompt you send.\n          </p>\n        </div>\n        <div className=\"flex flex-col gap-3\">\n          <ComboBox\n            {...containerProp}\n            initialValue={'slexaxton'}\n            options={[\n              { value: 'slexaxton', label: 'SlexAxton' },\n              { value: 'pierredotco', label: 'pierredotco' },\n              { value: 'jquery', label: 'jQuery' },\n            ]}\n          />\n        </div>\n      </div>\n    </>\n  );\n}\n",
      "type": "registry:component"
    }
  ]
}